# `01h`

## Key Topics

- [Introduction](#introduction)
  - [Behavior](#behavior)
- [Register Breakdown](#register-breakdown)
- [Examples](#examples)
- [Implementation Notes](#implementation-notes)

---

## Introduction

BIOS interrupt 15h function 24h subfunction 01h provides a standardized interface for enabling the A20 address line. This mechanism allows the processor to access memory above the 1 MB boundary by preventing address wrap-around that existed on the original IBM PC architecture.  

The A20 line must be enabled before entering protected mode to ensure that memory addressing works correctly and consistently. By using this BIOS function, system software can activate A20 without having to interact directly with hardware-specific ports or controllers. The BIOS abstracts these low-level details, providing a uniform method across platforms that implement the interface.

### Behavior

When invoked, this function instructs the BIOS to enable the A20 gate. The BIOS implementation handles all underlying hardware operations automatically—whether through the keyboard controller, the system control port (Fast A20), or chipset logic.  

If the BIOS supports the A20 control interface and successfully enables the line, the carry flag (CF) is cleared on return. If the BIOS does not implement the A20 gate functions at all, the carry flag is set, and the function fails. No other specific error codes are officially defined.

---

## Register Breakdown

To enable the A20 line, set `AH` to 24h and `AL` to 01h, then invoke interrupt 15h.  

On return, if the carry flag is clear, the BIOS has accepted and executed the request. If the carry flag is set, the function is not supported by the BIOS and the calling program should use a hardware fallback method to enable A20.

---

## Examples

### Basic Usage

```asm
mov ax, 0x2401      ; AH=24h (A20), AL=01h (enable)
int 0x15
jc no_support        ; CF=1 → BIOS doesn’t support A20 control
; CF=0 → BIOS successfully enabled A20
````

This simple example enables the A20 gate through the BIOS interface and checks for support using the carry flag. On older or minimal BIOS implementations, the function may not exist, so the code must be prepared to handle that case.

---

### Extended Example

```asm
; Enable A20 with verification and fallback
enable_a20:
    ; Try BIOS method first
    mov ax, 0x2401
    int 0x15
    jc .fallback          ; CF=1 → BIOS doesn’t support it

    ; Verify that A20 is actually enabled
    mov ax, 0x2402
    int 0x15
    jc .fallback
    test bl, 1
    jnz .done             ; Bit 0 = 1 → A20 enabled

.fallback:
    ; Use Fast A20 (port 0x92) as fallback
    in al, 0x92
    or al, 0x02
    out 0x92, al
.done:
    ret
```

This example demonstrates a robust enablement routine that first attempts the BIOS interface, then verifies its effect using subfunction 02h. If unsupported or ineffective, it falls back to a hardware method to ensure A20 is active.

---

## Implementation Notes

The BIOS A20 interface was originally introduced on IBM PS/2 systems and later adopted by compatible BIOS vendors such as AMI and Phoenix. Not all systems implement it; therefore, software must verify its presence by first calling subfunction 03h (`INT 15h, AX=2403h`) and checking the carry flag.

If the BIOS interface is unavailable, the recommended fallback is to use port 0x92 (Fast A20) or the keyboard controller command sequence.

On modern firmware such as SeaBIOS, this function is always implemented and will immediately enable the A20 line successfully. On legacy or minimalist BIOSes, the call may simply set the carry flag to indicate lack of support.

---
